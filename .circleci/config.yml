version: 2.1

orbs:
  android: circleci/android@2.0.3

jobs:
  unit-test:
    executor:
      name: android/android-machine
      resource-class: large
      steps:
        - checkout
        - android/restore-gradle-cache
        - android/restore-build-cache
        - run:
            name: Assemble release build
            command: |
              ./gradlew assembleRelease
        - store_artifacts:
            path: app/build/outputs/apk/release
            filters:
              branches:
                only: main